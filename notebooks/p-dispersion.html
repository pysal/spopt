<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>The P-Dispersion (max-min-min) Problem &#8212; spopt v0.7.0 Manual</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=9afac83c" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pysal-styles.css?v=e5dd7357" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script src="../_static/documentation_options.js?v=fe7df9b0"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"TeX": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}}, "tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="icon" href="../_static/pysal_favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Empirical examples of facility location problems" href="facloc-real-world.html" />
    <link rel="prev" title="Comparing P-Median Variations" href="p-median_variations.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          spopt</a>
        <span class="navbar-text navbar-version pull-left"><b>0.7.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../installation.html">Installation</a></li>
                <li><a href="../tutorials.html">Tutorials</a></li>
                <li><a href="../api.html">API</a></li>
                <li><a href="../references.html">References</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installing-released-version">Installing released version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installing-development-version">Installing development version</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="maxp.html">Max-P Regionalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="azp.html">Automatic Zoning Procedure (AZP) algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="sa3.html">Spatial Adaptive Agglomerative Aggregation (<span class="math notranslate nohighlight">\(SA^3\)</span>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="skater.html">SKATER</a></li>
<li class="toctree-l2"><a class="reference internal" href="ward.html">Ward</a></li>
<li class="toctree-l2"><a class="reference internal" href="reg-k-means.html">Regional-k-means</a></li>
<li class="toctree-l2"><a class="reference internal" href="randomregion.html">Random Regions</a></li>
<li class="toctree-l2"><a class="reference internal" href="component_policy.html">Max-P Regionalization for Multiple Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="lscp.html">The Location Set Covering Problem (LSCP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="lscp_gis.html">Siting First Aid Stations with LSCP on Toronto’s University Campus</a></li>
<li class="toctree-l2"><a class="reference internal" href="lscp_capacity.html">Capacitated Location Set Covering Problem–System Optimal (CLSCP-SO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="lscpb.html">The Backup Coverage Location Problem (LSCP-B)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mclp.html">The Maximal Coverage Location Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="mclp_gis.html">Siting Restaurants with MCLP in San Francisco</a></li>
<li class="toctree-l2"><a class="reference internal" href="p-center.html">P-Center Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="p-median.html">The P-Median Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="p-median_variations.html">Comparing P-Median Variations</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">The P-Dispersion (max-min-min) Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="facloc-real-world.html">Empirical examples of facility location problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="facloc-lscpb-real-world.html">Backup Coverage Location Problem: An Empirical Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="facloc-disperse-real-world.html">The P-Dispersion Problem: An Empirical Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api.html#region-methods">Region Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#locate-methods">Locate Methods</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">The P-Dispersion (max-min-min) Problem</a><ul>
<li><a class="reference internal" href="#Lattice-10x10">Lattice 10x10</a></li>
<li><a class="reference internal" href="#Simulate-points-in-a-network">Simulate points in a network</a></li>
<li><a class="reference internal" href="#Assign-simulated-points-network-locations">Assign simulated points network locations</a></li>
<li><a class="reference internal" href="#Calculating-the-(network-distance)-cost-matrix">Calculating the (network distance) cost matrix</a></li>
<li><a class="reference internal" href="#Calculating-euclidean-distance-from-a-GeoDataFrame">Calculating euclidean distance from a <code class="docutils literal notranslate"><span class="pre">GeoDataFrame</span></code></a></li>
<li><a class="reference internal" href="#Plotting-the-results">Plotting the results</a><ul>
<li><a class="reference internal" href="#P-Dispersion-built-from-cost-matrix-(network-distance)">P-Dispersion built from cost matrix (network distance)</a></li>
<li><a class="reference internal" href="#P-Dispersion-built-from-geodataframe-(euclidean-distance)">P-Dispersion built from geodataframe (euclidean distance)</a></li>
<li><a class="reference internal" href="#P-Dispersion-with-preselected-facilities-(euclidean-distance)">P-Dispersion with preselected facilities (euclidean distance)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Comparing-solution-from-varied-metrics">Comparing solution from varied metrics</a></li>
<li><a class="reference internal" href="#References">References</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="admonition note">
<p>This page was generated from <a class="reference external" href="https://github.com/pysal/spopt/blob/main/notebooks/p-dispersion.ipynb">notebooks/p-dispersion.ipynb</a>.
Interactive online version:
<span class="raw-html"><a href="https://mybinder.org/v2/gh/pysal/spopt/main?filepath=notebooks/p-dispersion.ipynb"><img alt="Binder badge" src="https://mybinder.org/badge_logo.svg" style="vertical-align:text-bottom"></a></span></p>
</div>
<section id="The-P-Dispersion-(max-min-min)-Problem">
<h1>The P-Dispersion (max-min-min) Problem<a class="headerlink" href="#The-P-Dispersion-(max-min-min)-Problem" title="Link to this heading">¶</a></h1>
<p><em>Authors:</em> <a class="reference external" href="https://github.com/erinrolson">Erin Olson</a>, <a class="reference external" href="https://github.com/jGaboardi">James Gaboardi</a>, <a class="reference external" href="https://github.com/ljwolf">Levi J. Wolf</a>, <a class="reference external" href="https://github.com/qszhao">Qunshan Zhao</a></p>
<p>When locating some types of facilites a primary objective may be to limit the potential for cascading adverse effects damage should one facility be damaged. Therefore, maximally dispersed arrangement would be the most beneficial. For example, power plants are generally not near other power plants as a precaution against localized damage or disablement during a natural disaster. To address this kind of scenarios with a mixed-integer program, Kuby (1987) described the following problem: <em>Locate
:math:`p` facilities so that the minimum distance between any pair of facilities is maximized.</em></p>
<p><strong>P-Dispersion can be written as:</strong></p>
<p><span class="math">\begin{equation*}
\textbf{Maximize } D
\end{equation*}</span></p>
<p><strong>Subject to:</strong> <span class="math">\begin{equation*}
\sum_{i \in I} Y_i = p
\end{equation*}</span></p>
<p><span class="math">\begin{equation*}
D \leq d_{ij} + M (2 - Y_{i} - Y_{j}), \quad \forall i \in I \quad \forall j > i
\end{equation*}</span></p>
<p><span class="math">\begin{equation*}
Y_i = \{0,1\}, \quad \forall i \in I
\end{equation*}</span></p>
<p><strong>Where:</strong></p>
<p><em>The above fomulation was adapted from Maliszewski et al (2012), the original formulation is from Kuby (1987).</em></p>
<p>This tutorial generates synthetic facility sites near a 10x10 lattice representing a gridded urban core. Three <span class="math notranslate nohighlight">\(p\)</span>-Dispersion instances are solved while varying parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PDispersion.from_cost_matrix()</span></code> with network distance as the metric</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PDispersion.from_geodataframe()</span></code> with euclidean distance as the metric</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PDispersion.from_geodataframe()</span></code> with predefined facility locations and euclidean distance as the metric</p></li>
</ul>
<p>Unlike other facility location models available in <code class="docutils literal notranslate"><span class="pre">spopt.locate</span></code>, the <span class="math notranslate nohighlight">\(p\)</span>-Dispersion problem does not take demand/client locations into consideration.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%config InlineBackend.figure_format = &quot;retina&quot;
%load_ext watermark
%watermark
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Last updated: 2025-04-07T15:07:14.389023-04:00

Python implementation: CPython
Python version       : 3.12.9
IPython version      : 9.0.2

Compiler    : Clang 18.1.8
OS          : Darwin
Release     : 24.4.0
Machine     : arm64
Processor   : arm
CPU cores   : 8
Architecture: 64bit

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import warnings

import geopandas
import matplotlib.lines as mlines
import matplotlib.pyplot as plt
import numpy
import pulp
import shapely
from matplotlib.patches import Patch

import spopt
from spopt.locate import PDispersion, simulated_geo_points

with warnings.catch_warnings():
    warnings.simplefilter(&quot;ignore&quot;)
    # ignore deprecation warning - GH pysal/spaghetti#649
    import spaghetti

%watermark -w
%watermark -iv
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Watermark: 2.5.0

pulp      : 2.8.0
spaghetti : 1.7.6
shapely   : 2.1.0
spopt     : 0.6.2.dev3+g13ca45e
matplotlib: 3.10.1
numpy     : 2.2.4
geopandas : 1.0.1

</pre></div></div>
</div>
<p>Since the model needs a cost matrix (distance, time, etc.) we should define some variables. First we will assign some the number of facility locations followed by the random seed in order to reproduce the results. Finally, the solver, assigned below as <code class="docutils literal notranslate"><span class="pre">pulp.COIN_CMD</span></code>, is an interface to optimization solver developed by <a class="reference external" href="https://github.com/coin-or/Cbc">COIN-OR</a>. If you want to use another optimization interface, such as Gurobi or CPLEX, see this [guide](<a class="reference external" href="https://coin">https://coin</a>-</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># quantity supply points
FACILITY_COUNT = 16

# number of candidate facilities in optimal solution
P_FACILITIES = 3

# random seeds for reproducibility
FACILITY_SEED = 6

# set the solver
solver = pulp.COIN_CMD(msg=False, warmStart=True)
</pre></div>
</div>
</div>
<section id="Lattice-10x10">
<h2>Lattice 10x10<a class="headerlink" href="#Lattice-10x10" title="Link to this heading">¶</a></h2>
<p>Create a 10x10 lattice with 9 interior lines, both vertical and horizontal.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>with warnings.catch_warnings():
    warnings.simplefilter(&quot;ignore&quot;)
    # ignore deprecation warning - GH pysal/libpysal#468
    lattice = spaghetti.regular_lattice((0, 0, 10, 10), 9, exterior=True)
ntw = spaghetti.Network(in_data=lattice)
</pre></div>
</div>
</div>
<p>Transform the <code class="docutils literal notranslate"><span class="pre">spaghetti</span></code> instance into a geodataframe.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>streets = spaghetti.element_as_gdf(ntw, arcs=True)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>streets_buffered = geopandas.GeoDataFrame(
    geopandas.GeoSeries(streets[&quot;geometry&quot;].buffer(0.5).union_all()),
    crs=streets.crs,
    columns=[&quot;geometry&quot;],
)
</pre></div>
</div>
</div>
<p>Plotting the network created by <code class="docutils literal notranslate"><span class="pre">spaghetti</span></code> we can verify that it mimics a district with quarters and streets.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>streets.plot();
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_p-dispersion_11_0.png" class="no-scaled-link" src="../_images/notebooks_p-dispersion_11_0.png" style="width: 416px; height: 413px;" />
</div>
</div>
</section>
<section id="Simulate-points-in-a-network">
<h2>Simulate points in a network<a class="headerlink" href="#Simulate-points-in-a-network" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">simulated_geo_points</span></code> function simulates points near a network. In this case, it uses the 10x10 lattice network created using the <code class="docutils literal notranslate"><span class="pre">spaghetti</span></code> package. Below we use the function defined above and simulate the points near the lattice edges.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>facility_points = simulated_geo_points(
    streets_buffered, needed=FACILITY_COUNT, seed=FACILITY_SEED
)
</pre></div>
</div>
</div>
<p>Plotting the facility points we can see that the function generates dummy points to an area of 10x10, which is the area created by our lattice created on previous cells.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, ax = plt.subplots(figsize=(6, 6))
streets.plot(ax=ax, alpha=0.8, zorder=1, label=&quot;streets&quot;)
facility_points.plot(
    ax=ax,
    color=&quot;red&quot;,
    zorder=2,
    label=f&quot;facility candidate sites ($n$={FACILITY_COUNT})&quot;,
)
plt.legend(loc=&quot;upper left&quot;, bbox_to_anchor=(1.05, 1));
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_p-dispersion_15_0.png" class="no-scaled-link" src="../_images/notebooks_p-dispersion_15_0.png" style="width: 776px; height: 505px;" />
</div>
</div>
</section>
<section id="Assign-simulated-points-network-locations">
<h2>Assign simulated points network locations<a class="headerlink" href="#Assign-simulated-points-network-locations" title="Link to this heading">¶</a></h2>
<p>The facility points do not adhere to network space. Calculating distances between them without restricting movement to the network results in a euclidean distances,’as the crow flies.’ While this is acceptable for some applications, for others it is more realistic to consider network traversal (e.g. Does a mail carrier follow roads to deliver letters or fly from mailbox to mailbox?).</p>
<p>In our first example we will consider distance along the 10x10 lattice network created above. Therefore, we must first snap the observation points to the network prior to calculating a cost matrix.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>with warnings.catch_warnings():
    warnings.simplefilter(&quot;ignore&quot;)
    # ignore deprecation warning - GH pysal/libpysal#468
    ntw.snapobservations(facility_points, &quot;facilities&quot;, attribute=True)
facilities_snapped = spaghetti.element_as_gdf(ntw, pp_name=&quot;facilities&quot;, snapped=True)
facilities_snapped.drop(columns=[&quot;id&quot;, &quot;comp_label&quot;], inplace=True)
</pre></div>
</div>
</div>
<p>Now the plot seems more organized as the points occupy network space. The network is plotted below with the network locations of the facility points.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, ax = plt.subplots(figsize=(6, 6))
streets.plot(ax=ax, alpha=0.8, zorder=1, label=&quot;streets&quot;)
facilities_snapped.plot(
    ax=ax,
    color=&quot;red&quot;,
    zorder=2,
    label=f&quot;facility candidate sites ($n$={FACILITY_COUNT})&quot;,
)
plt.legend(loc=&quot;upper left&quot;, bbox_to_anchor=(1.05, 1));
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_p-dispersion_19_0.png" class="no-scaled-link" src="../_images/notebooks_p-dispersion_19_0.png" style="width: 798px; height: 505px;" />
</div>
</div>
</section>
<section id="Calculating-the-(network-distance)-cost-matrix">
<h2>Calculating the (network distance) cost matrix<a class="headerlink" href="#Calculating-the-(network-distance)-cost-matrix" title="Link to this heading">¶</a></h2>
<p>Calculate the inter-facility network distance.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cost_matrix = ntw.allneighbordistances(
    sourcepattern=ntw.pointpatterns[&quot;facilities&quot;], fill_diagonal=0.0
)
cost_matrix.shape
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(16, 16)
</pre></div></div>
</div>
<p>The expected result here is a network distance facilities points, in our case a 2D 16x16*** array.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cost_matrix[:5, :5]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 0.        ,  3.78794131, 11.63723819,  4.99347068,  9.66917542],
       [ 3.78794131,  0.        , 13.84929687,  7.20552937, 11.88123411],
       [11.63723819, 13.84929687,  0.        ,  6.6437675 ,  2.66349027],
       [ 4.99347068,  7.20552937,  6.6437675 ,  0.        ,  4.67570474],
       [ 9.66917542, 11.88123411,  2.66349027,  4.67570474,  0.        ]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cost_matrix[-5:, -5:]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 0.        ,  3.15016768,  9.526461  ,  9.71401032,  3.00949261],
       [ 3.15016768,  0.        , 10.67662868,  6.56384263,  4.93972891],
       [ 9.526461  , 10.67662868,  0.        , 11.24047132,  6.51696839],
       [ 9.71401032,  6.56384263, 11.24047132,  0.        , 11.50357155],
       [ 3.00949261,  4.93972891,  6.51696839, 11.50357155,  0.        ]])
</pre></div></div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">PDispersion.from_cost_matrix</span></code> we model the <span class="math notranslate nohighlight">\(p\)</span>-dispersion problem to maximize the minimum inter-facility cost (in this case network distance in generic units, as calculated above) while siting <span class="math notranslate nohighlight">\(p\)</span> facilites.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>pdispersion_from_cm = PDispersion.from_cost_matrix(
    cost_matrix, P_FACILITIES, name=&quot;p-dispersion-network-distance&quot;
)
pdispersion_from_cm = pdispersion_from_cm.solve(solver)
pdispersion_from_cm
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;spopt.locate.p_dispersion.PDispersion at 0x152e3da90&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>pdispersion_obj = round(pdispersion_from_cm.problem.objective.value(), 3)
print(
    &quot;A maximized minimum inter-facility distance between any two sited candiate &quot;
    f&quot;facilities of {pdispersion_obj} distance units is observed while siting &quot;
    f&quot;facilities at {P_FACILITIES} of the available {FACILITY_COUNT} locations.&quot;
)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
A maximized minimum inter-facility distance between any two sited candiate facilities of 10.706 distance units is observed while siting facilities at 3 of the available 16 locations.
</pre></div></div>
</div>
<p>Define the decision variable names used for mapping later.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>facility_points[&quot;dv&quot;] = pdispersion_from_cm.fac_vars
facility_points[&quot;dv&quot;] = facility_points[&quot;dv&quot;].map(lambda x: x.name.replace(&quot;_&quot;, &quot;&quot;))
facilities_snapped[&quot;dv&quot;] = facility_points[&quot;dv&quot;]
facility_points
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
      <th>dv</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>POINT (9.32146 3.15178)</td>
      <td>y0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>POINT (8.53352 -0.04134)</td>
      <td>y1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>POINT (0.68422 6.04557)</td>
      <td>y2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>POINT (5.32799 4.10688)</td>
      <td>y3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>POINT (3.18949 6.34771)</td>
      <td>y4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>POINT (4.31956 7.5947)</td>
      <td>y5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>POINT (5.1984 5.86744)</td>
      <td>y6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>POINT (6.59891 10.39247)</td>
      <td>y7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>POINT (8.51844 4.04521)</td>
      <td>y8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>POINT (9.13894 8.56135)</td>
      <td>y9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>POINT (0.09922 7.40501)</td>
      <td>y10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>POINT (8.32388 7.60047)</td>
      <td>y11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>POINT (7.30045 5.45031)</td>
      <td>y12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>POINT (0.87307 10.03412)</td>
      <td>y13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>POINT (3.93582 1.88646)</td>
      <td>y14</td>
    </tr>
    <tr>
      <th>15</th>
      <td>POINT (7.39003 10.43628)</td>
      <td>y15</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Calculating-euclidean-distance-from-a-GeoDataFrame">
<h2>Calculating euclidean distance from a <code class="docutils literal notranslate"><span class="pre">GeoDataFrame</span></code><a class="headerlink" href="#Calculating-euclidean-distance-from-a-GeoDataFrame" title="Link to this heading">¶</a></h2>
<p>With <code class="docutils literal notranslate"><span class="pre">PDispersion.from_cost_matrix</span></code> we model the <span class="math notranslate nohighlight">\(p\)</span>-dispersion problem to maximize the minimum inter-facility cost (in this case euclidean distance in generic units) while siting <span class="math notranslate nohighlight">\(p\)</span> facilites.</p>
<p>Next we will solve the <span class="math notranslate nohighlight">\(p\)</span>-dispersion problem considering all candidate locations for potential selection.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>distance_metric = &quot;euclidean&quot;
pdispersion_from_gdf = PDispersion.from_geodataframe(
    facilities_snapped,
    &quot;geometry&quot;,
    P_FACILITIES,
    distance_metric=distance_metric,
    name=f&quot;p-dispersion-{distance_metric}-distance&quot;,
)
pdispersion_from_gdf = pdispersion_from_gdf.solve(solver)
pdispersion_from_gdf
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;spopt.locate.p_dispersion.PDispersion at 0x152e3ce60&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>pdispersion_obj = round(pdispersion_from_gdf.problem.objective.value(), 3)
print(
    &quot;A maximized minimum inter-facility distance between any two sited candiate &quot;
    f&quot;facilities of {pdispersion_obj} distance units is observed while siting &quot;
    f&quot;facilities at {P_FACILITIES} of the available {FACILITY_COUNT} locations.&quot;
)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
A maximized minimum inter-facility distance between any two sited candiate facilities of 8.574 distance units is observed while siting facilities at 3 of the available 16 locations.
</pre></div></div>
</div>
<p>However, in many real world applications there may already be existing facility locations with the goal being to add one or more new facilities. Here we will define facilites <span class="math notranslate nohighlight">\(y_{11}\)</span> and <span class="math notranslate nohighlight">\(y_{12}\)</span> as already existing (they must be present in the model solution). This will lead to a sub-optimal solution.</p>
<p><strong>Important:</strong> The facilities in <code class="docutils literal notranslate"><span class="pre">&quot;predefined_loc&quot;</span></code> are a binary array where <code class="docutils literal notranslate"><span class="pre">1</span></code> means the associated location must appear in the solution.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>facility_points[&quot;predefined_loc&quot;] = 0
facility_points.loc[(11, 12), &quot;predefined_loc&quot;] = 1
facilities_snapped[&quot;predefined_loc&quot;] = facility_points[&quot;predefined_loc&quot;]
facility_points
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
      <th>dv</th>
      <th>predefined_loc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>POINT (9.32146 3.15178)</td>
      <td>y0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>POINT (8.53352 -0.04134)</td>
      <td>y1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>POINT (0.68422 6.04557)</td>
      <td>y2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>POINT (5.32799 4.10688)</td>
      <td>y3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>POINT (3.18949 6.34771)</td>
      <td>y4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>POINT (4.31956 7.5947)</td>
      <td>y5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>POINT (5.1984 5.86744)</td>
      <td>y6</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>POINT (6.59891 10.39247)</td>
      <td>y7</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>POINT (8.51844 4.04521)</td>
      <td>y8</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>POINT (9.13894 8.56135)</td>
      <td>y9</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>POINT (0.09922 7.40501)</td>
      <td>y10</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>POINT (8.32388 7.60047)</td>
      <td>y11</td>
      <td>1</td>
    </tr>
    <tr>
      <th>12</th>
      <td>POINT (7.30045 5.45031)</td>
      <td>y12</td>
      <td>1</td>
    </tr>
    <tr>
      <th>13</th>
      <td>POINT (0.87307 10.03412)</td>
      <td>y13</td>
      <td>0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>POINT (3.93582 1.88646)</td>
      <td>y14</td>
      <td>0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>POINT (7.39003 10.43628)</td>
      <td>y15</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>pdispersion_from_gdf_pre = PDispersion.from_geodataframe(
    facilities_snapped,
    &quot;geometry&quot;,
    P_FACILITIES,
    predefined_facility_col=&quot;predefined_loc&quot;,
    distance_metric=distance_metric,
    name=f&quot;p-dispersion-{distance_metric}-distance-predefined&quot;,
)
pdispersion_from_gdf_pre = pdispersion_from_gdf_pre.solve(solver)
pdispersion_from_gdf_pre
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;spopt.locate.p_dispersion.PDispersion at 0x152e3fb90&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>pdispersion_obj = round(pdispersion_from_gdf_pre.problem.objective.value(), 3)
print(
    &quot;A maximized minimum inter-facility distance between any two sited candiate &quot;
    f&quot;facilities of {pdispersion_obj} distance units is observed while siting &quot;
    f&quot;facilities at {P_FACILITIES} of the available {FACILITY_COUNT} locations.&quot;
)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
A maximized minimum inter-facility distance between any two sited candiate facilities of 2.371 distance units is observed while siting facilities at 3 of the available 16 locations.
</pre></div></div>
</div>
</section>
<section id="Plotting-the-results">
<h2>Plotting the results<a class="headerlink" href="#Plotting-the-results" title="Link to this heading">¶</a></h2>
<p>The two cells below describe the plotting of the results. For each method from the <code class="docutils literal notranslate"><span class="pre">PDispersion</span></code> class (<code class="docutils literal notranslate"><span class="pre">.from_cost_matrix()</span></code>, <code class="docutils literal notranslate"><span class="pre">.from_geodataframe()</span></code>) there is a plot displaying the facility site that was selected with a colored star.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>dv_colors_arr = [
    &quot;darkcyan&quot;,
    &quot;mediumseagreen&quot;,
    &quot;saddlebrown&quot;,
    &quot;darkslategray&quot;,
    &quot;lightskyblue&quot;,
    &quot;thistle&quot;,
    &quot;lavender&quot;,
    &quot;darkgoldenrod&quot;,
    &quot;peachpuff&quot;,
    &quot;coral&quot;,
    &quot;mediumvioletred&quot;,
    &quot;blueviolet&quot;,
    &quot;fuchsia&quot;,
    &quot;cyan&quot;,
    &quot;limegreen&quot;,
    &quot;mediumorchid&quot;,
]
dv_colors = {f&quot;y{i}&quot;: dv_colors_arr[i] for i in range(len(dv_colors_arr))}
dv_colors
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;y0&#39;: &#39;darkcyan&#39;,
 &#39;y1&#39;: &#39;mediumseagreen&#39;,
 &#39;y2&#39;: &#39;saddlebrown&#39;,
 &#39;y3&#39;: &#39;darkslategray&#39;,
 &#39;y4&#39;: &#39;lightskyblue&#39;,
 &#39;y5&#39;: &#39;thistle&#39;,
 &#39;y6&#39;: &#39;lavender&#39;,
 &#39;y7&#39;: &#39;darkgoldenrod&#39;,
 &#39;y8&#39;: &#39;peachpuff&#39;,
 &#39;y9&#39;: &#39;coral&#39;,
 &#39;y10&#39;: &#39;mediumvioletred&#39;,
 &#39;y11&#39;: &#39;blueviolet&#39;,
 &#39;y12&#39;: &#39;fuchsia&#39;,
 &#39;y13&#39;: &#39;cyan&#39;,
 &#39;y14&#39;: &#39;limegreen&#39;,
 &#39;y15&#39;: &#39;mediumorchid&#39;}
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def plot_results(model, p, facs, clis=None, ax=None):
    &quot;&quot;&quot;Visualize optimal solution sets and context.&quot;&quot;&quot;
    if not ax:
        multi_plot = False
        fig, ax = plt.subplots(figsize=(6, 6))
        markersize, markersize_factor = 4, 4
    else:
        ax.axis(&quot;off&quot;)
        multi_plot = True
        markersize, markersize_factor = 2, 2

    ax.set_title(model.name, fontsize=15)
    facility_count = len(model.fac_vars)
    fac_sites = {}

    plot_clis = isinstance(clis, geopandas.GeoDataFrame)
    if plot_clis:
        cli_points = {}

    for i, dv in enumerate(model.fac_vars):
        if dv.varValue:
            dv, predef = facs.loc[i, [&quot;dv&quot;, &quot;predefined_loc&quot;]]
            fac_sites[dv] = [i, predef]
            if plot_clis:
                geom = clis.iloc[model.fac2cli[i]][&quot;geometry&quot;]
                cli_points[dv] = geom

    # study area and legend entries initialization
    streets.plot(ax=ax, alpha=1, color=&quot;black&quot;, zorder=1)
    legend_elements = [mlines.Line2D([], [], color=&quot;black&quot;, label=&quot;streets&quot;)]

    if plot_clis and model.name.startswith(&quot;mclp&quot;):
        # any clients that not asscociated with a facility
        c = &quot;k&quot;
        if model.n_cli_uncov:
            idx = [i for i, v in enumerate(model.cli2fac) if len(v) == 0]
            pnt_kws = {
                &quot;ax&quot;: ax,
                &quot;fc&quot;: c,
                &quot;ec&quot;: c,
                &quot;marker&quot;: &quot;s&quot;,
                &quot;markersize&quot;: 7,
                &quot;zorder&quot;: 2,
            }
            clis.iloc[idx].plot(**pnt_kws)
        _label = f&quot;Demand sites not covered ($n$={model.n_cli_uncov})&quot;
        _mkws = {
            &quot;marker&quot;: &quot;s&quot;,
            &quot;markerfacecolor&quot;: c,
            &quot;markeredgecolor&quot;: c,
            &quot;linewidth&quot;: 0,
        }
        legend_elements.append(mlines.Line2D([], [], ms=3, label=_label, **_mkws))

    # all candidate facilities
    facs.plot(ax=ax, fc=&quot;brown&quot;, marker=&quot;*&quot;, markersize=80, zorder=8)
    _label = f&quot;Facility sites ($n$={facility_count})&quot;
    _mkws = {&quot;marker&quot;: &quot;*&quot;, &quot;markerfacecolor&quot;: &quot;brown&quot;, &quot;markeredgecolor&quot;: &quot;brown&quot;}
    legend_elements.append(mlines.Line2D([], [], ms=7, lw=0, label=_label, **_mkws))

    # client-facility symbology and legend entries
    zorder = 4
    for fname, (fac, predef) in fac_sites.items():
        cset = dv_colors[fname]

        if plot_clis:
            # clients
            geoms = cli_points[fname]
            gdf = geopandas.GeoDataFrame(geoms)
            gdf.plot(ax=ax, zorder=zorder, ec=&quot;k&quot;, fc=cset, markersize=100 * markersize)
            _label = f&quot;Demand sites covered by {fname}&quot;
            _mkws = {
                &quot;markerfacecolor&quot;: cset,
                &quot;markeredgecolor&quot;: &quot;k&quot;,
                &quot;ms&quot;: markersize + 7,
            }
            legend_elements.append(
                mlines.Line2D([], [], marker=&quot;o&quot;, lw=0, label=_label, **_mkws)
            )
        # facilities
        ec = &quot;k&quot;
        lw = 2
        predef_label = &quot;predefined&quot;
        if model.name.endswith(predef_label) and predef:
            ec = &quot;r&quot;
            lw = 3
            fname += f&quot; ({predef_label})&quot;
        facs.iloc[[fac]].plot(
            ax=ax, marker=&quot;*&quot;, markersize=1000, zorder=9, fc=cset, ec=ec, lw=lw
        )
        _mkws = {&quot;markerfacecolor&quot;: cset, &quot;markeredgecolor&quot;: ec, &quot;markeredgewidth&quot;: lw}
        legend_elements.append(
            mlines.Line2D([], [], marker=&quot;*&quot;, ms=20, lw=0, label=fname, **_mkws)
        )
        # increment zorder up and markersize down for stacked client symbology
        zorder += 1
        if plot_clis:
            markersize -= markersize_factor / p

    if not multi_plot:
        # legend
        kws = {&quot;loc&quot;: &quot;upper left&quot;, &quot;bbox_to_anchor&quot;: (1.05, 0.7)}
        plt.legend(handles=legend_elements, **kws)
</pre></div>
</div>
</div>
<section id="P-Dispersion-built-from-cost-matrix-(network-distance)">
<h3>P-Dispersion built from cost matrix (network distance)<a class="headerlink" href="#P-Dispersion-built-from-cost-matrix-(network-distance)" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plot_results(pdispersion_from_cm, P_FACILITIES, facility_points)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_p-dispersion_41_0.png" class="no-scaled-link" src="../_images/notebooks_p-dispersion_41_0.png" style="width: 706px; height: 529px;" />
</div>
</div>
</section>
<section id="P-Dispersion-built-from-geodataframe-(euclidean-distance)">
<h3>P-Dispersion built from geodataframe (euclidean distance)<a class="headerlink" href="#P-Dispersion-built-from-geodataframe-(euclidean-distance)" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plot_results(pdispersion_from_gdf, P_FACILITIES, facility_points)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_p-dispersion_43_0.png" class="no-scaled-link" src="../_images/notebooks_p-dispersion_43_0.png" style="width: 706px; height: 529px;" />
</div>
</div>
</section>
<section id="P-Dispersion-with-preselected-facilities-(euclidean-distance)">
<h3>P-Dispersion with preselected facilities (euclidean distance)<a class="headerlink" href="#P-Dispersion-with-preselected-facilities-(euclidean-distance)" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plot_results(pdispersion_from_gdf_pre, P_FACILITIES, facility_points)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_p-dispersion_45_0.png" class="no-scaled-link" src="../_images/notebooks_p-dispersion_45_0.png" style="width: 706px; height: 529px;" />
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="Comparing-solution-from-varied-metrics">
<h2>Comparing solution from varied metrics<a class="headerlink" href="#Comparing-solution-from-varied-metrics" title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, axarr = plt.subplots(1, 3, figsize=(20, 10))
fig.subplots_adjust(wspace=-0.01)
for i, m in enumerate(
    [pdispersion_from_cm, pdispersion_from_gdf, pdispersion_from_gdf_pre]
):
    plot_results(m, P_FACILITIES, facility_points, ax=axarr[i])
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_p-dispersion_47_0.png" class="no-scaled-link" src="../_images/notebooks_p-dispersion_47_0.png" style="width: 1569px; height: 588px;" />
</div>
</div>
<p>All 3 solutions to the <span class="math notranslate nohighlight">\(p\)</span>-dispersion problem vary spatially, as seen above, but they also all include facility <span class="math notranslate nohighlight">\(y_1\)</span> since it is the most isolated location. A good demonstration of the intended results of dispersion can be seen in the first two models, <code class="docutils literal notranslate"><span class="pre">P-Dispersion-network-distance</span></code> and <code class="docutils literal notranslate"><span class="pre">P-Dispersion-euclidean-distance</span></code>, where the selected candidate facilites are arranged to form pseudo-equilateral triangles. Of course, the <code class="docutils literal notranslate"><span class="pre">P-Dispersion-euclidean-distance-predefined</span></code> model
does not follow this pattern due to the stipulation that facilities <span class="math notranslate nohighlight">\(y_{11}\)</span> and <span class="math notranslate nohighlight">\(y_{12}\)</span> be included in the optimal solution.</p>
</section>
<section id="References">
<h2>References<a class="headerlink" href="#References" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1538-4632.1987.tb00133.x">Kuby, Michael J. 1987. Programming Models for Facility Dispersion: The p-Dispersion and Maximum Dispersion Problems. Geographical Analysis, 19, 315–329.</a></p></li>
<li><p><a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0198971511001293?via%3Dihub">Maliszewski, Paul J., Michael J. Kuby, and Mark W. Horner. 2012. A comparison of multi-objective spatial dispersion models for managing critical assets in urban areas. Computers, Environment and Urban Systems. 36 (4):331-341.</a></p></li>
</ul>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../_sources/notebooks/p-dispersion.ipynb.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2020-, pysal developers.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 8.2.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>