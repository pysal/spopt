<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Capacitated Location Set Covering Problem–System Optimal (CLSCP-SO) &#8212; spopt v0.7.0rc1 Manual</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=9afac83c" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pysal-styles.css?v=e5dd7357" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script src="../_static/documentation_options.js?v=61228ca7"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"TeX": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}}, "tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="icon" href="../_static/pysal_favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The Backup Coverage Location Problem (LSCP-B)" href="lscpb.html" />
    <link rel="prev" title="Siting First Aid Stations with LSCP on Toronto’s University Campus" href="lscp_gis.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          spopt</a>
        <span class="navbar-text navbar-version pull-left"><b>0.7.0rc1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../installation.html">Installation</a></li>
                <li><a href="../tutorials.html">Tutorials</a></li>
                <li><a href="../api.html">API</a></li>
                <li><a href="../references.html">References</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installing-released-version">Installing released version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installing-development-version">Installing development version</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="maxp.html">Max-P Regionalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="azp.html">Automatic Zoning Procedure (AZP) algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="sa3.html">Spatial Adaptive Agglomerative Aggregation (<span class="math notranslate nohighlight">\(SA^3\)</span>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="skater.html">SKATER</a></li>
<li class="toctree-l2"><a class="reference internal" href="ward.html">Ward</a></li>
<li class="toctree-l2"><a class="reference internal" href="reg-k-means.html">Regional-k-means</a></li>
<li class="toctree-l2"><a class="reference internal" href="randomregion.html">Random Regions</a></li>
<li class="toctree-l2"><a class="reference internal" href="component_policy.html">Max-P Regionalization for Multiple Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="lscp.html">The Location Set Covering Problem (LSCP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="lscp_gis.html">Siting First Aid Stations with LSCP on Toronto’s University Campus</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Capacitated Location Set Covering Problem–System Optimal (CLSCP-SO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="lscpb.html">The Backup Coverage Location Problem (LSCP-B)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mclp.html">The Maximal Coverage Location Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="mclp_gis.html">Siting Restaurants with MCLP in San Francisco</a></li>
<li class="toctree-l2"><a class="reference internal" href="p-center.html">P-Center Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="p-median.html">The P-Median Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="p-median_variations.html">Comparing P-Median Variations</a></li>
<li class="toctree-l2"><a class="reference internal" href="p-dispersion.html">The P-Dispersion (max-min-min) Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="facloc-real-world.html">Empirical examples of facility location problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="facloc-lscpb-real-world.html">Backup Coverage Location Problem: An Empirical Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="facloc-disperse-real-world.html">The P-Dispersion Problem: An Empirical Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api.html#region-methods">Region Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#locate-methods">Locate Methods</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Capacitated Location Set Covering Problem–System Optimal (CLSCP-SO)</a><ul>
<li><a class="reference internal" href="#1.-Data-and-setup">1. Data and setup</a><ul>
<li><a class="reference internal" href="#Lattice-10x10">Lattice 10x10</a></li>
<li><a class="reference internal" href="#Simulate-points-in-a-network">Simulate points in a network</a></li>
<li><a class="reference internal" href="#Assign-simulated-points-network-locations">Assign simulated points network locations</a></li>
<li><a class="reference internal" href="#Calculating-the-(network-distance)-cost-matrix">Calculating the (network distance) cost matrix</a></li>
</ul>
</li>
<li><a class="reference internal" href="#2.-Demonstrating-CLSCP-SO-behavior">2. Demonstrating CLSCP-SO behavior</a><ul>
<li><a class="reference internal" href="#Generating-synthetic-client-demand-and-facility-capacity">Generating synthetic client demand and facility capacity</a></li>
<li><a class="reference internal" href="#Scenario-1">Scenario 1</a></li>
<li><a class="reference internal" href="#Scenario-2">Scenario 2</a></li>
<li><a class="reference internal" href="#Scenario-3">Scenario 3</a></li>
<li><a class="reference internal" href="#Scenario-4">Scenario 4</a></li>
<li><a class="reference internal" href="#Scenario-5">Scenario 5</a></li>
<li><a class="reference internal" href="#Scenario-6">Scenario 6</a></li>
<li><a class="reference internal" href="#Plotting-the-results">Plotting the results</a></li>
<li><a class="reference internal" href="#id6">Scenario 1</a></li>
<li><a class="reference internal" href="#id7">Scenario 2</a></li>
<li><a class="reference internal" href="#id8">Scenario 3</a></li>
<li><a class="reference internal" href="#id9">Scenario 4</a></li>
<li><a class="reference internal" href="#id10">Scenario 5</a></li>
<li><a class="reference internal" href="#id11">Scenario 6</a></li>
<li><a class="reference internal" href="#A-comparison-of-the-solutions">A comparison of the solutions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#3.-Comparing-covering-problems">3. Comparing covering problems</a><ul>
<li><a class="reference internal" href="#Parameters-and-input-data">Parameters and input data</a></li>
<li><a class="reference internal" href="#Stipulate-that-facility-y_5-must-be-a-member-of-the-solution-set">Stipulate that facility <span class="math notranslate nohighlight">\(y_5\)</span> must be a member of the solution set</a></li>
<li><a class="reference internal" href="#Generate-synthetic-demand">Generate synthetic demand</a></li>
<li><a class="reference internal" href="#Generate-synthetic-capacity-equal-to-at-least-2x-demand">Generate synthetic capacity equal to at least 2x demand</a></li>
<li><a class="reference internal" href="#Solve-&amp;-plot-the-CLSCP-SO">Solve &amp; plot the CLSCP-SO</a></li>
<li><a class="reference internal" href="#Solve-&amp;-plot-the-standard-LSCP">Solve &amp; plot the standard LSCP</a></li>
<li><a class="reference internal" href="#Compare-the-results">Compare the results</a></li>
</ul>
</li>
<li><a class="reference internal" href="#References">References</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="admonition note">
<p>This page was generated from <a class="reference external" href="https://github.com/pysal/spopt/blob/main/notebooks/lscp_capacity.ipynb">notebooks/lscp_capacity.ipynb</a>.
Interactive online version:
<span class="raw-html"><a href="https://mybinder.org/v2/gh/pysal/spopt/main?filepath=notebooks/lscp_capacity.ipynb"><img alt="Binder badge" src="https://mybinder.org/badge_logo.svg" style="vertical-align:text-bottom"></a></span></p>
</div>
<section id="Capacitated-Location-Set-Covering-Problem–System-Optimal-(CLSCP-SO)">
<h1>Capacitated Location Set Covering Problem–System Optimal (CLSCP-SO)<a class="headerlink" href="#Capacitated-Location-Set-Covering-Problem–System-Optimal-(CLSCP-SO)" title="Link to this heading">¶</a></h1>
<p><em>Authors:</em> <a class="reference external" href="https://github.com/erinrolson">Erin Olson</a>, <a class="reference external" href="https://github.com/gegen07">Germano Barcelos</a>, <a class="reference external" href="https://github.com/jGaboardi">James Gaboardi</a>, <a class="reference external" href="https://github.com/ljwolf">Levi J. Wolf</a>, <a class="reference external" href="https://github.com/qszhao">Qunshan Zhao</a></p>
<p>The Capacitated Location Set Covering – System Optimal (CLSCP-SO) model builds off of the <a class="reference external" href="https://pysal.org/spopt/notebooks/lscp.html">LSCP</a>, but allows for the assignment of a facility’s capacity and the amount of demand at a demand point to be used in the siting of facilities. CLSCP-SO can be described as follows:</p>
<p>“<em>Locate just enough facilities and associated capacity such that all demand is served within the capacity limits of each facility, given the coverage capabilities of each facility.</em>” Church L. &amp; Murray, A. (2018)</p>
<p><strong>CLSCP-SO can be written as:</strong></p>
<p>:math:<a href="#id2"><span class="problematic" id="id3">`</span></a>begin{array}
displaystyle textbf{Minimize}    &amp; displaystyle sum_{j in J}{Y_j} &amp;&amp; (1) \
displaystyle textbf{Subject to:} &amp; displaystyle sum_{j in N_i}{z_{ij}} = 1 &amp; forall i in I &amp; (2) \</p>
<blockquote>
<div><p>&amp; displaystyle sum_{i in I} a_i z_{ij} leq C_jx_j &amp; forall j in J &amp; (3) \
&amp; Y_j in {0,1} &amp; forall j in J &amp; (4) \
&amp; z_{ij} geq 0 &amp; forall i in I quad forall j in N_i &amp; (5) \</p>
</div></blockquote>
<p>end{array}`</p>
<p>:math:<a href="#id4"><span class="problematic" id="id5">`</span></a>begin{array}
displaystyle textbf{Where:}\ &amp; &amp; displaystyle i &amp; small = &amp; textrm{index of demand points/areas/objects in set } I \
&amp; &amp; j &amp; small = &amp; textrm{index of potential facility sites in set } J \
&amp; &amp; S &amp; small = &amp; textrm{maximal acceptable service distance or time standard} \
&amp; &amp; d_{ij} &amp; small = &amp; textrm{shortest distance or travel time between nodes } i textrm{ and } j \
&amp; &amp; N_i &amp; small = &amp; {j | d_{ij} &lt; S} \
&amp; &amp; a_i &amp; small = &amp; textrm{amount of demand at } i \
&amp; &amp; C_j &amp; small = &amp; textrm{capacity of potential facility } j \
&amp; &amp; z_{ij} &amp; small = &amp; textrm{fraction of demand } i textrm{ that is assigned to facility } j \
&amp; &amp; Y_j &amp; small = &amp; begin{cases}</p>
<blockquote>
<div><blockquote>
<div><p>1, text{if a facility is located at node } j\
0, text{otherwise} \</p>
</div></blockquote>
<p>end{cases}</p>
</div></blockquote>
<p>end{array}`</p>
<p><em>The formulation above is adapted from Church and Murray (2018).</em></p>
<hr class="docutils" />
<p>This tutorial solves the CLSCP-SO by generating synthetic demand (clients) and facility sites near a 10x10 lattice representing a gridded urban core, and is broken out as follows:</p>
<ol class="arabic simple">
<li><p>Data and setup</p></li>
<li><p>Demonstrating the CLSCP-SO with 2 facilities and 5 five client sites</p></li>
</ol>
<ul class="simple">
<li><p>Six scenarios are detailed in which facility capacity is swapped between sites</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Comparing solutions to covering problems with a single pre-defined facility</p></li>
</ol>
<ul class="simple">
<li><p>CLSCP-SO</p></li>
<li><p>standard LSCP</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%config InlineBackend.figure_format = &quot;retina&quot;
%load_ext watermark
%watermark
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Last updated: 2025-04-07T13:54:40.173927-04:00

Python implementation: CPython
Python version       : 3.12.9
IPython version      : 9.0.2

Compiler    : Clang 18.1.8
OS          : Darwin
Release     : 24.4.0
Machine     : arm64
Processor   : arm
CPU cores   : 8
Architecture: 64bit

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import warnings

import geopandas
import matplotlib.lines as mlines
import matplotlib.pyplot as plt
import numpy
import pandas
import pulp
import shapely
from matplotlib.patches import Patch

import spopt
from spopt.locate import LSCP, LSCPB, MCLP, simulated_geo_points

with warnings.catch_warnings():
    warnings.simplefilter(&quot;ignore&quot;)
    # ignore deprecation warning - GH pysal/spaghetti#649
    import spaghetti

%watermark -w
%watermark -iv
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Watermark: 2.5.0

pandas    : 2.2.3
matplotlib: 3.10.1
shapely   : 2.1.0
spopt     : 0.6.2.dev3+g13ca45e
geopandas : 1.0.1
pulp      : 2.8.0
spaghetti : 1.7.6
numpy     : 2.2.4

</pre></div></div>
</div>
<hr class="docutils" />
<section id="1.-Data-and-setup">
<h2>1. Data and setup<a class="headerlink" href="#1.-Data-and-setup" title="Link to this heading">¶</a></h2>
<p>Since the model needs a distance cost matrix we should define some variables. In the comments, it’s defined what these variables are for but solver. The solver, assigned below as <code class="docutils literal notranslate"><span class="pre">pulp.PULP_CBC_CMD</span></code>, is an interface to optimization solver developed by <a class="reference external" href="https://github.com/coin-or/Cbc">COIN-OR</a>. If you want to use another optimization interface as Gurobi or CPLEX see this <a class="reference external" href="https://coin-or.github.io/pulp/guides/how_to_configure_solvers.html">guide</a> that explains how to achieve this.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># quantity demand points
CLIENT_COUNT = 5

# quantity supply points
FACILITY_COUNT = 2

# maximum service radius (in distance units)
SERVICE_RADIUS = 15

# random seeds for reproducibility
CLIENT_SEED = 5
FACILITY_SEED = 6

# set the solver
solver = pulp.COIN_CMD(msg=False, warmStart=True)
</pre></div>
</div>
</div>
<section id="Lattice-10x10">
<h3>Lattice 10x10<a class="headerlink" href="#Lattice-10x10" title="Link to this heading">¶</a></h3>
<p>Create a 10x10 lattice with 9 interior lines, both vertical and horizontal.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>with warnings.catch_warnings():
    warnings.simplefilter(&quot;ignore&quot;)
    # ignore deprecation warning - GH pysal/libpysal#468
    lattice = spaghetti.regular_lattice((0, 0, 10, 10), 9, exterior=True)
ntw = spaghetti.Network(in_data=lattice)
</pre></div>
</div>
</div>
<p>Transform the <code class="docutils literal notranslate"><span class="pre">spaghetti</span></code> instance into a geodataframe.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>streets = spaghetti.element_as_gdf(ntw, arcs=True)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>streets_buffered = geopandas.GeoDataFrame(
    geopandas.GeoSeries(streets[&quot;geometry&quot;].buffer(0.2).union_all()),
    crs=streets.crs,
    columns=[&quot;geometry&quot;],
)
</pre></div>
</div>
</div>
<p>Plotting the network created by <code class="docutils literal notranslate"><span class="pre">spaghetti</span></code> we can verify that it mimics a district with quarters and streets.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>streets.plot();
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_lscp_capacity_11_0.png" class="no-scaled-link" src="../_images/notebooks_lscp_capacity_11_0.png" style="width: 416px; height: 413px;" />
</div>
</div>
</section>
<section id="Simulate-points-in-a-network">
<h3>Simulate points in a network<a class="headerlink" href="#Simulate-points-in-a-network" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">simulated_geo_points</span></code> function simulates points near a network. In this case, it uses the 10x10 lattice network created using the <code class="docutils literal notranslate"><span class="pre">spaghetti</span></code> package. Below we use the function defined above and simulate the points near the lattice edges.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>client_points = simulated_geo_points(
    streets_buffered, needed=CLIENT_COUNT, seed=CLIENT_SEED
)
facility_points = simulated_geo_points(
    streets_buffered, needed=FACILITY_COUNT, seed=FACILITY_SEED
)
</pre></div>
</div>
</div>
<p>Plotting the 5 client and 2 facility points we can see that the function generates dummy points to an area of 10x10, which is the area created by our lattice created on previous cells.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, ax = plt.subplots(figsize=(6, 6))
streets.plot(ax=ax, alpha=0.8, zorder=1, label=&quot;streets&quot;)
facility_points.plot(
    ax=ax,
    color=&quot;red&quot;,
    zorder=2,
    label=f&quot;facility candidate sites ($n$={FACILITY_COUNT})&quot;,
)
client_points.plot(ax=ax, color=&quot;black&quot;, label=f&quot;clients sites ($n$={CLIENT_COUNT})&quot;)
plt.legend(loc=&quot;upper left&quot;, bbox_to_anchor=(1.05, 1));
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_lscp_capacity_15_0.png" class="no-scaled-link" src="../_images/notebooks_lscp_capacity_15_0.png" style="width: 790px; height: 505px;" />
</div>
</div>
</section>
<section id="Assign-simulated-points-network-locations">
<h3>Assign simulated points network locations<a class="headerlink" href="#Assign-simulated-points-network-locations" title="Link to this heading">¶</a></h3>
<p>The simulated client and facility points do not adhere to network space. Calculating distances between them without restricting movement to the network results in a euclidean distances,’as the crow flies.’ While this is acceptable for some applications, for others it is more realistic to consider network traversal (e.g. Does a mail carrier follow roads to deliver letters or fly from mailbox to mailbox?).</p>
<p>In our first example we will consider distance along the 10x10 lattice network created above. Therefore, we must first snap the observation points to the network prior to calculating a cost matrix.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>with warnings.catch_warnings():
    warnings.simplefilter(&quot;ignore&quot;)
    # ignore deprecation warning - GH pysal/libpysal#468
    ntw.snapobservations(client_points, &quot;clients&quot;, attribute=True)
clients_snapped = spaghetti.element_as_gdf(ntw, pp_name=&quot;clients&quot;, snapped=True)
clients_snapped.drop(columns=[&quot;id&quot;, &quot;comp_label&quot;], inplace=True)

with warnings.catch_warnings():
    warnings.simplefilter(&quot;ignore&quot;)
    # ignore deprecation warning - GH pysal/libpysal#468
    ntw.snapobservations(facility_points, &quot;facilities&quot;, attribute=True)
facilities_snapped = spaghetti.element_as_gdf(ntw, pp_name=&quot;facilities&quot;, snapped=True)
facilities_snapped.drop(columns=[&quot;id&quot;, &quot;comp_label&quot;], inplace=True)
</pre></div>
</div>
</div>
<p>Now the plot seems more organized as the points occupy network space. The network is plotted below with the network locations of the facility points and clients points.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, ax = plt.subplots(figsize=(6, 6))
streets.plot(ax=ax, alpha=0.8, zorder=1, label=&quot;streets&quot;)
facilities_snapped.plot(
    ax=ax,
    color=&quot;red&quot;,
    zorder=2,
    label=f&quot;facility candidate sites ($n$={FACILITY_COUNT})&quot;,
)
clients_snapped.plot(ax=ax, color=&quot;black&quot;, label=f&quot;clients sites ($n$={CLIENT_COUNT})&quot;)
plt.legend(loc=&quot;upper left&quot;, bbox_to_anchor=(1.05, 1));
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_lscp_capacity_19_0.png" class="no-scaled-link" src="../_images/notebooks_lscp_capacity_19_0.png" style="width: 790px; height: 505px;" />
</div>
</div>
</section>
<section id="Calculating-the-(network-distance)-cost-matrix">
<h3>Calculating the (network distance) cost matrix<a class="headerlink" href="#Calculating-the-(network-distance)-cost-matrix" title="Link to this heading">¶</a></h3>
<p>Calculate the network distance between clients and facilities.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cost_matrix = ntw.allneighbordistances(
    sourcepattern=ntw.pointpatterns[&quot;clients&quot;],
    destpattern=ntw.pointpatterns[&quot;facilities&quot;],
)
cost_matrix.shape
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(5, 2)
</pre></div></div>
</div>
<p>The expected result here is a network distance between clients and facilities points, in our case a 2D 5x2 array.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cost_matrix
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[12.60302601,  3.93598651],
       [13.10096347,  4.43392397],
       [ 6.9095462 ,  4.2425067 ],
       [ 2.98196832,  7.84581224],
       [ 7.5002892 ,  6.32806975]])
</pre></div></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="2.-Demonstrating-CLSCP-SO-behavior">
<h2>2. Demonstrating CLSCP-SO behavior<a class="headerlink" href="#2.-Demonstrating-CLSCP-SO-behavior" title="Link to this heading">¶</a></h2>
<section id="Generating-synthetic-client-demand-and-facility-capacity">
<h3>Generating synthetic client demand and facility capacity<a class="headerlink" href="#Generating-synthetic-client-demand-and-facility-capacity" title="Link to this heading">¶</a></h3>
<p>First create synthetic demand total 15 units.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>client_points[&quot;demand&quot;] = numpy.arange(1, 6)
client_points
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
      <th>demand</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>POINT (2.10873 8.85562)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>POINT (1.94988 9.35355)</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>POINT (4.87948 6.16214)</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>POINT (7.76544 5.19155)</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>POINT (2.88673 1.7523)</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>By manipulating client demand and facility capacity we can demonstrate how capacity is accounted for and generates different results. We’ll do this using 6 different scenarios while adjusting the capacities at the two sites.</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(1 \gg 2 \quad [15, 5]\)</span>: Facility 1 has much more capacity than Facility 2. Only Facility 1 provides a feasible solution.</p></li>
<li><p><span class="math notranslate nohighlight">\(1 \ll 2 \quad [5, 15]\)</span>: Facility 1 has much less capacity than Facility 2. Only Facility 2 provides a feasible solution.</p></li>
<li><p><span class="math notranslate nohighlight">\(1 \gtrapprox 2 \quad [8, 7]\)</span>: Facility 1 and Facility 2 have nearly equal capacity, but Facility 1 is slightly larger. Neither facility can serve all demand alone.</p></li>
<li><p><span class="math notranslate nohighlight">\(1 \equiv 2 \quad [15, 15]\)</span>: Facility 1 and Facility 2 have equivalent capacity. Either facility can serve all demand.</p></li>
<li><p><span class="math notranslate nohighlight">\(1 \gtrapprox 2 \quad [16, 15]\)</span>: Facility 1 and Facility 2 have nearly equal capacity, but Facility 1 is slightly larger. Either facility can serve all demand.</p></li>
<li><p><span class="math notranslate nohighlight">\(1 \lessapprox 2 \quad [15, 16]\)</span>: Facility 1 and Facility 2 have nearly equal capacity, but Facility 2 is slightly larger. Either facility can serve all demand.</p></li>
</ol>
<p>Since the sum of demand quantity is 15, the problem will be feasible in all cases. We know this because the capacity of the system must always be greater than the demand.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>facility_points[&quot;cap_1&quot;] = [15, 5]
facility_points[&quot;cap_2&quot;] = [5, 15]
facility_points[&quot;cap_3&quot;] = [8, 7]
facility_points[&quot;cap_4&quot;] = [15, 15]
facility_points[&quot;cap_5&quot;] = [16, 15]
facility_points[&quot;cap_6&quot;] = [15, 16]
facility_points
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
      <th>cap_1</th>
      <th>cap_2</th>
      <th>cap_3</th>
      <th>cap_4</th>
      <th>cap_5</th>
      <th>cap_6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>POINT (9.08575 3.25259)</td>
      <td>15</td>
      <td>5</td>
      <td>8</td>
      <td>15</td>
      <td>16</td>
      <td>15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>POINT (0.91963 5.98854)</td>
      <td>5</td>
      <td>15</td>
      <td>7</td>
      <td>15</td>
      <td>15</td>
      <td>16</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">LSCP.from_cost_matrix</span></code> we model the CLSCP-SO to cover all demand points within <code class="docutils literal notranslate"><span class="pre">SERVICE_RADIUS</span></code> distance units using the network distance cost matrix calculated above.</p>
</section>
<section id="Scenario-1">
<h3>Scenario 1<a class="headerlink" href="#Scenario-1" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>facility 1 capacity &gt;&gt; facility 2 capacity</p></li>
<li><p>only Facility 1 provides a feasible solution</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>clscpso_1 = LSCP.from_cost_matrix(
    cost_matrix,
    SERVICE_RADIUS,
    demand_quantity_arr=client_points[&quot;demand&quot;],
    facility_capacity_arr=facility_points[&quot;cap_1&quot;],
    name=&quot;CLSCP-SO_$1\\gg2$&quot;,
)
</pre></div>
</div>
</div>
<p>The expected result is a solved instance of <code class="docutils literal notranslate"><span class="pre">LSCP</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>clscpso_1 = clscpso_1.solve(solver)
clscpso_1
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;spopt.locate.coverage.LSCP at 0x139a03cb0&gt;
</pre></div></div>
</div>
<p>Define the decision variable names used for mapping later.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>facility_points[&quot;dv&quot;] = clscpso_1.fac_vars
facility_points[&quot;dv&quot;] = facility_points[&quot;dv&quot;].map(lambda x: x.name.replace(&quot;_&quot;, &quot;&quot;))
facility_points
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
      <th>cap_1</th>
      <th>cap_2</th>
      <th>cap_3</th>
      <th>cap_4</th>
      <th>cap_5</th>
      <th>cap_6</th>
      <th>dv</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>POINT (9.08575 3.25259)</td>
      <td>15</td>
      <td>5</td>
      <td>8</td>
      <td>15</td>
      <td>16</td>
      <td>15</td>
      <td>y0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>POINT (0.91963 5.98854)</td>
      <td>5</td>
      <td>15</td>
      <td>7</td>
      <td>15</td>
      <td>15</td>
      <td>16</td>
      <td>y1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Scenario-2">
<h3>Scenario 2<a class="headerlink" href="#Scenario-2" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>facility 1 capacity &lt;&lt; facility 2 capacity</p></li>
<li><p>only Facility 2 provides a feasible solution</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>clscpso_2 = LSCP.from_cost_matrix(
    cost_matrix,
    SERVICE_RADIUS,
    demand_quantity_arr=client_points[&quot;demand&quot;],
    facility_capacity_arr=facility_points[&quot;cap_2&quot;],
    name=&quot;CLSCP-SO_$1\\ll2$&quot;,
)
clscpso_2 = clscpso_2.solve(solver)
</pre></div>
</div>
</div>
</section>
<section id="Scenario-3">
<h3>Scenario 3<a class="headerlink" href="#Scenario-3" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>facility 1 capacity <span class="math notranslate nohighlight">\(\gtrapprox\)</span> facility 2 capacity</p></li>
<li><p>neither facility can serve all demand alone</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>clscpso_3 = LSCP.from_cost_matrix(
    cost_matrix,
    SERVICE_RADIUS,
    demand_quantity_arr=client_points[&quot;demand&quot;],
    facility_capacity_arr=facility_points[&quot;cap_3&quot;],
    name=&quot;CLSCP-SO_$1\\gtrapprox2$_low&quot;,
)
clscpso_3 = clscpso_3.solve(solver)
</pre></div>
</div>
</div>
</section>
<section id="Scenario-4">
<h3>Scenario 4<a class="headerlink" href="#Scenario-4" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>facility 1 capacity <span class="math notranslate nohighlight">\(\equiv\)</span> facility 2 capacity</p></li>
<li><p>either facility can serve all demand</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>clscpso_4 = LSCP.from_cost_matrix(
    cost_matrix,
    SERVICE_RADIUS,
    demand_quantity_arr=client_points[&quot;demand&quot;],
    facility_capacity_arr=facility_points[&quot;cap_4&quot;],
    name=&quot;CLSCP-SO_$1\\equiv2$_high&quot;,
)
clscpso_4 = clscpso_4.solve(solver)
</pre></div>
</div>
</div>
</section>
<section id="Scenario-5">
<h3>Scenario 5<a class="headerlink" href="#Scenario-5" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>facility 1 capacity <span class="math notranslate nohighlight">\(\gtrapprox\)</span> facility 2 capacity</p></li>
<li><p>either facility can serve all demand</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>clscpso_5 = LSCP.from_cost_matrix(
    cost_matrix,
    SERVICE_RADIUS,
    demand_quantity_arr=client_points[&quot;demand&quot;],
    facility_capacity_arr=facility_points[&quot;cap_5&quot;],
    name=&quot;CLSCP-SO_$1\\gtrapprox2$_high&quot;,
)
clscpso_5 = clscpso_5.solve(solver)
</pre></div>
</div>
</div>
</section>
<section id="Scenario-6">
<h3>Scenario 6<a class="headerlink" href="#Scenario-6" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>facility 1 capacity <span class="math notranslate nohighlight">\(\lessapprox\)</span> facility 2 capacity</p></li>
<li><p>either facility can serve all demand</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>clscpso_6 = LSCP.from_cost_matrix(
    cost_matrix,
    SERVICE_RADIUS,
    demand_quantity_arr=client_points[&quot;demand&quot;],
    facility_capacity_arr=facility_points[&quot;cap_6&quot;],
    name=&quot;CLSCP-SO_$1\\lessapprox2$_high&quot;,
)
clscpso_6 = clscpso_6.solve(solver)
</pre></div>
</div>
</div>
</section>
<section id="Plotting-the-results">
<h3>Plotting the results<a class="headerlink" href="#Plotting-the-results" title="Link to this heading">¶</a></h3>
<p>The two cells below describe the plotting of the results. The plots display the facility sites that were selected with a star colored and the points covered with the same color. Demand points covered by more than one facility are displayed in overlapping concentric circles.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>dv_colors_arr = [
    &quot;darkcyan&quot;,
    &quot;mediumseagreen&quot;,
    &quot;saddlebrown&quot;,
    &quot;darkslategray&quot;,
    &quot;lightskyblue&quot;,
    &quot;thistle&quot;,
    &quot;lavender&quot;,
    &quot;darkgoldenrod&quot;,
    &quot;peachpuff&quot;,
    &quot;coral&quot;,
    &quot;mediumvioletred&quot;,
    &quot;blueviolet&quot;,
    &quot;fuchsia&quot;,
    &quot;cyan&quot;,
    &quot;limegreen&quot;,
    &quot;mediumorchid&quot;,
]
dv_colors = {f&quot;y{i}&quot;: dv_colors_arr[i] for i in range(len(dv_colors_arr))}
dv_colors
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;y0&#39;: &#39;darkcyan&#39;,
 &#39;y1&#39;: &#39;mediumseagreen&#39;,
 &#39;y2&#39;: &#39;saddlebrown&#39;,
 &#39;y3&#39;: &#39;darkslategray&#39;,
 &#39;y4&#39;: &#39;lightskyblue&#39;,
 &#39;y5&#39;: &#39;thistle&#39;,
 &#39;y6&#39;: &#39;lavender&#39;,
 &#39;y7&#39;: &#39;darkgoldenrod&#39;,
 &#39;y8&#39;: &#39;peachpuff&#39;,
 &#39;y9&#39;: &#39;coral&#39;,
 &#39;y10&#39;: &#39;mediumvioletred&#39;,
 &#39;y11&#39;: &#39;blueviolet&#39;,
 &#39;y12&#39;: &#39;fuchsia&#39;,
 &#39;y13&#39;: &#39;cyan&#39;,
 &#39;y14&#39;: &#39;limegreen&#39;,
 &#39;y15&#39;: &#39;mediumorchid&#39;}
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def plot_results(model, p, facs, clis=None, ax=None):
    &quot;&quot;&quot;Visualize optimal solution sets and context.&quot;&quot;&quot;
    if not ax:
        multi_plot = False
        fig, ax = plt.subplots(figsize=(6, 6))
        markersize, markersize_factor = 4, 4
    else:
        ax.axis(&quot;off&quot;)
        multi_plot = True
        markersize, markersize_factor = 2, 2
    ax.set_title(model.name, fontsize=15)

    # extract facility-client relationships for plotting (except for p-dispersion)
    plot_clis = isinstance(clis, geopandas.GeoDataFrame)
    if plot_clis:
        cli_points = {}
    fac_sites = {}
    for i, dv in enumerate(model.fac_vars):
        if dv.varValue:
            dv, predef = facs.loc[i, [&quot;dv&quot;, &quot;predefined_loc&quot;]]
            fac_sites[dv] = [i, predef]
            if plot_clis:
                geom = clis.iloc[model.fac2cli[i]][&quot;geometry&quot;]
                cli_points[dv] = geom

    # study area and legend entries initialization
    streets.plot(ax=ax, alpha=1, color=&quot;black&quot;, zorder=1)
    legend_elements = [mlines.Line2D([], [], color=&quot;black&quot;, label=&quot;streets&quot;)]

    if plot_clis and model.name.startswith(&quot;mclp&quot;):
        # any clients that not asscociated with a facility
        c = &quot;k&quot;
        if model.n_cli_uncov:
            idx = [i for i, v in enumerate(model.cli2fac) if len(v) == 0]
            pnt_kws = {
                &quot;ax&quot;: ax,
                &quot;fc&quot;: c,
                &quot;ec&quot;: c,
                &quot;marker&quot;: &quot;s&quot;,
                &quot;markersize&quot;: 7,
                &quot;zorder&quot;: 2,
            }
            clis.iloc[idx].plot(**pnt_kws)
        _label = f&quot;Demand sites not covered ($n$={model.n_cli_uncov})&quot;
        _mkws = {
            &quot;marker&quot;: &quot;s&quot;,
            &quot;markerfacecolor&quot;: c,
            &quot;markeredgecolor&quot;: c,
            &quot;linewidth&quot;: 0,
        }
        legend_elements.append(mlines.Line2D([], [], ms=3, label=_label, **_mkws))

    # all candidate facilities
    facs.plot(ax=ax, fc=&quot;brown&quot;, marker=&quot;*&quot;, markersize=80, zorder=8)
    _label = f&quot;Facility sites ($n$={len(model.fac_vars)})&quot;
    _mkws = {&quot;marker&quot;: &quot;*&quot;, &quot;markerfacecolor&quot;: &quot;brown&quot;, &quot;markeredgecolor&quot;: &quot;brown&quot;}
    legend_elements.append(mlines.Line2D([], [], ms=7, lw=0, label=_label, **_mkws))

    # facility-(client) symbology and legend entries
    zorder = 4
    for fname, (fac, predef) in fac_sites.items():
        cset = dv_colors[fname]
        if plot_clis:
            # clients
            geoms = cli_points[fname]
            gdf = geopandas.GeoDataFrame(geoms)
            gdf.plot(ax=ax, zorder=zorder, ec=&quot;k&quot;, fc=cset, markersize=100 * markersize)
            _label = f&quot;Demand sites covered by {fname}&quot;
            _mkws = {
                &quot;markerfacecolor&quot;: cset,
                &quot;markeredgecolor&quot;: &quot;k&quot;,
                &quot;ms&quot;: markersize + 7,
            }
            legend_elements.append(
                mlines.Line2D([], [], marker=&quot;o&quot;, lw=0, label=_label, **_mkws)
            )
        # facilities
        ec = &quot;k&quot;
        lw = 2
        predef_label = &quot;predefined&quot;
        if model.name.endswith(predef_label) and predef:
            ec = &quot;r&quot;
            lw = 3
            fname += f&quot; ({predef_label})&quot;
        facs.iloc[[fac]].plot(
            ax=ax, marker=&quot;*&quot;, markersize=1000, zorder=9, fc=cset, ec=ec, lw=lw
        )
        _mkws = {&quot;markerfacecolor&quot;: cset, &quot;markeredgecolor&quot;: ec, &quot;markeredgewidth&quot;: lw}
        legend_elements.append(
            mlines.Line2D([], [], marker=&quot;*&quot;, ms=20, lw=0, label=fname, **_mkws)
        )
        # increment zorder up and markersize down for stacked client symbology
        zorder += 1
        if plot_clis:
            markersize -= markersize_factor / p

    if not multi_plot:
        # legend
        kws = {&quot;loc&quot;: &quot;upper left&quot;, &quot;bbox_to_anchor&quot;: (1.05, 0.7)}
        plt.legend(handles=legend_elements, **kws)
</pre></div>
</div>
</div>
</section>
<section id="id6">
<h3>Scenario 1<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>facility_points[&quot;predefined_loc&quot;] = 0
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plot_results(
    clscpso_1, clscpso_1.problem.objective.value(), facility_points, clis=client_points
)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_lscp_capacity_49_0.png" class="no-scaled-link" src="../_images/notebooks_lscp_capacity_49_0.png" style="width: 788px; height: 530px;" />
</div>
</div>
<p>Facility <span class="math notranslate nohighlight">\(y_0\)</span> is selected because it is the only feasible solution with a capacity of 15.</p>
</section>
<section id="id7">
<h3>Scenario 2<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plot_results(
    clscpso_2, clscpso_2.problem.objective.value(), facility_points, clis=client_points
)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_lscp_capacity_51_0.png" class="no-scaled-link" src="../_images/notebooks_lscp_capacity_51_0.png" style="width: 788px; height: 530px;" />
</div>
</div>
<p>When swapping the capacities from scenario 1, Facility <span class="math notranslate nohighlight">\(y_1\)</span> is selected because it is the only feasible solution with a capacity of 15.</p>
</section>
<section id="id8">
<h3>Scenario 3<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plot_results(
    clscpso_3, clscpso_3.problem.objective.value(), facility_points, clis=client_points
)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_lscp_capacity_53_0.png" class="no-scaled-link" src="../_images/notebooks_lscp_capacity_53_0.png" style="width: 788px; height: 530px;" />
</div>
</div>
<p>In scenario 3 neither facilities have the capacity to be the sole server of all client locations. However, they do have a combined capacity of 15. Therefore, both Facility <span class="math notranslate nohighlight">\(y_0\)</span> and Facility <span class="math notranslate nohighlight">\(y_1\)</span> are selected in the solution. Moreover, all client locations are within the 15 distance unit <code class="docutils literal notranslate"><span class="pre">SERVICE_RADIUS</span></code> from both facilities so they both can potentially serve all locations.</p>
</section>
<section id="id9">
<h3>Scenario 4<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plot_results(
    clscpso_4, clscpso_4.problem.objective.value(), facility_points, clis=client_points
)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_lscp_capacity_55_0.png" class="no-scaled-link" src="../_images/notebooks_lscp_capacity_55_0.png" style="width: 788px; height: 530px;" />
</div>
</div>
<p>When setting facility capacities as equivalent, and high enough to serve the complete set of demand, only 1 facility is needed to satisfy the objective. The selection of Facility <span class="math notranslate nohighlight">\(y_1\)</span> is arbitrary in this case and may differ according to the internal state when the solver begins the solution process.</p>
</section>
<section id="id10">
<h3>Scenario 5<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plot_results(
    clscpso_5, clscpso_5.problem.objective.value(), facility_points, clis=client_points
)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_lscp_capacity_57_0.png" class="no-scaled-link" src="../_images/notebooks_lscp_capacity_57_0.png" style="width: 788px; height: 530px;" />
</div>
</div>
<p>Scenario 5 shows that when both facilities are capable of serving all the demand, the facility with a higher capacity (Facility <span class="math notranslate nohighlight">\(y_0\)</span> in this case) is selected.</p>
</section>
<section id="id11">
<h3>Scenario 6<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plot_results(
    clscpso_6, clscpso_6.problem.objective.value(), facility_points, clis=client_points
)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_lscp_capacity_59_0.png" class="no-scaled-link" src="../_images/notebooks_lscp_capacity_59_0.png" style="width: 788px; height: 530px;" />
</div>
</div>
<p>Scenario 6 demostrates the reverse situation from above in Scenario 5. Facility <span class="math notranslate nohighlight">\(y_1\)</span> is selected over Facility <span class="math notranslate nohighlight">\(y_0\)</span> because it has a larger capacity.</p>
</section>
<section id="A-comparison-of-the-solutions">
<h3>A comparison of the solutions<a class="headerlink" href="#A-comparison-of-the-solutions" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>scenarios = [clscpso_1, clscpso_2, clscpso_3, clscpso_4, clscpso_5, clscpso_6]
fig, axarr = plt.subplots(1, len(scenarios), figsize=(20, 10))
fig.subplots_adjust(wspace=-0.01)
for i, m in enumerate(scenarios):
    plot_results(
        m, m.problem.objective.value(), facility_points, clis=client_points, ax=axarr[i]
    )
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_lscp_capacity_61_0.png" class="no-scaled-link" src="../_images/notebooks_lscp_capacity_61_0.png" style="width: 1570px; height: 305px;" />
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="3.-Comparing-covering-problems">
<h2>3. Comparing covering problems<a class="headerlink" href="#3.-Comparing-covering-problems" title="Link to this heading">¶</a></h2>
<p>Next we will set up, solve, and compare the CLSCP-SO to the standard LSCP with both more client locations and facilities. We will also stipulate that Facility <span class="math notranslate nohighlight">\(y_5\)</span> must be part of the optimal solution in both models.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def snap_obs(_ntw, df, label):
    with warnings.catch_warnings():
        warnings.simplefilter(&quot;ignore&quot;)
        # ignore deprecation warning - GH pysal/libpysal#468
        _ntw.snapobservations(df, label, attribute=True)
    df_snapped = spaghetti.element_as_gdf(_ntw, pp_name=label, snapped=True)
    df_snapped.drop(columns=[&quot;id&quot;, &quot;comp_label&quot;], inplace=True)
    return df_snapped
</pre></div>
</div>
</div>
<section id="Parameters-and-input-data">
<h3>Parameters and input data<a class="headerlink" href="#Parameters-and-input-data" title="Link to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># quantity demand points, supply points, &amp; maximum service radius (in distance units)
CLIENT_COUNT, FACILITY_COUNT, SERVICE_RADIUS = 100, 10, 7

# generate  input data
_buff = geopandas.GeoSeries(streets[&quot;geometry&quot;].buffer(0.5).union_all())
_buff = geopandas.GeoDataFrame(geometry=_buff, crs=streets.crs)
client_points = simulated_geo_points(_buff, needed=CLIENT_COUNT, seed=CLIENT_SEED)
facility_points = simulated_geo_points(_buff, needed=FACILITY_COUNT, seed=FACILITY_SEED)
snap_obs(ntw, client_points, &quot;clients&quot;)
snap_obs(ntw, facility_points, &quot;facilities&quot;)

# calculate the OD cost matrix
orig, dest = ntw.pointpatterns[&quot;clients&quot;], ntw.pointpatterns[&quot;facilities&quot;]
cost_matrix = ntw.allneighbordistances(sourcepattern=orig, destpattern=dest)
</pre></div>
</div>
</div>
</section>
<section id="Stipulate-that-facility-y_5-must-be-a-member-of-the-solution-set">
<h3>Stipulate that facility <span class="math notranslate nohighlight">\(y_5\)</span> must be a member of the solution set<a class="headerlink" href="#Stipulate-that-facility-y_5-must-be-a-member-of-the-solution-set" title="Link to this heading">¶</a></h3>
<p><strong>Important:</strong> The facilities in <code class="docutils literal notranslate"><span class="pre">&quot;predefined_loc&quot;</span></code> are a binary array where <code class="docutils literal notranslate"><span class="pre">1</span></code> means the associated location must appear in the solution.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>facility_points[&quot;predefined_loc&quot;] = 0
facility_points.loc[[5], &quot;predefined_loc&quot;] = 1
</pre></div>
</div>
</div>
</section>
<section id="Generate-synthetic-demand">
<h3>Generate synthetic demand<a class="headerlink" href="#Generate-synthetic-demand" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>numpy.random.seed(222)
demand_quantity = numpy.random.randint(1, 5, CLIENT_COUNT)
total_demand = demand_quantity.sum()
client_points[&quot;demand&quot;] = demand_quantity
print(f&quot;Total demand: {total_demand}&quot;)
demand_quantity
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Total demand: 238
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([3, 2, 4, 3, 3, 3, 1, 2, 3, 2, 4, 2, 4, 1, 1, 1, 1, 4, 3, 1, 1, 1,
       1, 2, 4, 4, 4, 1, 3, 4, 2, 2, 2, 1, 4, 2, 1, 3, 2, 2, 4, 4, 4, 4,
       1, 2, 2, 1, 2, 2, 2, 4, 1, 2, 2, 4, 2, 4, 1, 1, 1, 1, 1, 2, 2, 1,
       1, 1, 2, 4, 4, 4, 2, 2, 3, 3, 2, 3, 3, 1, 3, 1, 1, 3, 1, 2, 4, 1,
       4, 4, 3, 3, 1, 4, 1, 4, 4, 4, 3, 1])
</pre></div></div>
</div>
</section>
<section id="Generate-synthetic-capacity-equal-to-at-least-2x-demand">
<h3>Generate synthetic capacity equal to at least 2x demand<a class="headerlink" href="#Generate-synthetic-capacity-equal-to-at-least-2x-demand" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cap_sum_search = True
numpy.random.seed(0)
while cap_sum_search:
    facility_capacity = numpy.random.randint(5, 100, FACILITY_COUNT)
    if facility_capacity.sum() &gt;= demand_quantity.sum() * 2:
        cap_sum_search = False
facility_points[&quot;capacity&quot;] = facility_capacity
print(f&quot;Total capacity: {facility_points[&#39;capacity&#39;].sum()}&quot;)
facility_points
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Total capacity: 575
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
      <th>predefined_loc</th>
      <th>capacity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>POINT (9.32146 3.15178)</td>
      <td>0</td>
      <td>49</td>
    </tr>
    <tr>
      <th>1</th>
      <td>POINT (8.53352 -0.04134)</td>
      <td>0</td>
      <td>52</td>
    </tr>
    <tr>
      <th>2</th>
      <td>POINT (0.68422 6.04557)</td>
      <td>0</td>
      <td>69</td>
    </tr>
    <tr>
      <th>3</th>
      <td>POINT (5.32799 4.10688)</td>
      <td>0</td>
      <td>72</td>
    </tr>
    <tr>
      <th>4</th>
      <td>POINT (3.18949 6.34771)</td>
      <td>0</td>
      <td>72</td>
    </tr>
    <tr>
      <th>5</th>
      <td>POINT (4.31956 7.5947)</td>
      <td>1</td>
      <td>14</td>
    </tr>
    <tr>
      <th>6</th>
      <td>POINT (5.1984 5.86744)</td>
      <td>0</td>
      <td>88</td>
    </tr>
    <tr>
      <th>7</th>
      <td>POINT (6.59891 10.39247)</td>
      <td>0</td>
      <td>26</td>
    </tr>
    <tr>
      <th>8</th>
      <td>POINT (8.51844 4.04521)</td>
      <td>0</td>
      <td>41</td>
    </tr>
    <tr>
      <th>9</th>
      <td>POINT (9.13894 8.56135)</td>
      <td>0</td>
      <td>92</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Solve-&amp;-plot-the-CLSCP-SO">
<h3>Solve &amp; plot the CLSCP-SO<a class="headerlink" href="#Solve-&-plot-the-CLSCP-SO" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>clscpso = LSCP.from_cost_matrix(
    cost_matrix,
    SERVICE_RADIUS,
    demand_quantity_arr=demand_quantity,
    facility_capacity_arr=facility_capacity,
    predefined_facilities_arr=facility_points[&quot;predefined_loc&quot;],
    name=&quot;CLSCP-SO_predefined&quot;,
)
clscpso = clscpso.solve(solver)
facility_points[&quot;dv&quot;] = clscpso.fac_vars
facility_points[&quot;dv&quot;] = facility_points[&quot;dv&quot;].map(lambda x: x.name.replace(&quot;_&quot;, &quot;&quot;))
plot_results(
    clscpso, clscpso.problem.objective.value(), facility_points, clis=client_points
)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_lscp_capacity_73_0.png" class="no-scaled-link" src="../_images/notebooks_lscp_capacity_73_0.png" style="width: 791px; height: 525px;" />
</div>
</div>
</section>
<section id="Solve-&amp;-plot-the-standard-LSCP">
<h3>Solve &amp; plot the standard LSCP<a class="headerlink" href="#Solve-&-plot-the-standard-LSCP" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>lscp = LSCP.from_cost_matrix(
    cost_matrix,
    SERVICE_RADIUS,
    predefined_facilities_arr=facility_points[&quot;predefined_loc&quot;],
    name=&quot;lscp_predefined&quot;,
)
lscp = lscp.solve(solver)
plot_results(lscp, lscp.problem.objective.value(), facility_points, clis=client_points)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_lscp_capacity_75_0.png" class="no-scaled-link" src="../_images/notebooks_lscp_capacity_75_0.png" style="width: 791px; height: 525px;" />
</div>
</div>
</section>
<section id="Compare-the-results">
<h3>Compare the results<a class="headerlink" href="#Compare-the-results" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>models = [clscpso, lscp]
fig, axarr = plt.subplots(1, len(models), figsize=(10, 10))
fig.subplots_adjust(wspace=-0.01, hspace=-0.01)
for i, m in enumerate(models):
    plot_results(
        m, m.problem.objective.value(), facility_points, clis=client_points, ax=axarr[i]
    )
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_lscp_capacity_77_0.png" class="no-scaled-link" src="../_images/notebooks_lscp_capacity_77_0.png" style="width: 794px; height: 427px;" />
</div>
</div>
<p>Here we can see the solutions to the CLSCP-SO and LSCP are very similar. Facilities <span class="math notranslate nohighlight">\(y_1\)</span> (green), <span class="math notranslate nohighlight">\(y_2\)</span> (brown), <span class="math notranslate nohighlight">\(y_5\)</span> (darker violet), and <span class="math notranslate nohighlight">\(y_9\)</span> (orange) are present in both solutions, with <span class="math notranslate nohighlight">\(y_5\)</span> being pre-defined in both. In fact, the only difference between the two models is the inclusion of Facility <span class="math notranslate nohighlight">\(y_6\)</span> (lighter lilac) in the CLSCP-SO solution. This difference is due to taking client demand into consideration along with facility capacity.</p>
</section>
</section>
<hr class="docutils" />
<section id="References">
<h2>References<a class="headerlink" href="#References" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.springer.com/gb/book/9783319998459">Church, R. L., &amp; Murray, A. T. (2018). Location covering models: History, Applications and Advancements (1st edition 2018). Springer</a></p></li>
<li><p><a class="reference external" href="https://journals.sagepub.com/doi/abs/10.1068/b150153">Current, J. R., &amp; Storbeck, J. E. (1988). Capacitated Covering Models. Environment and Planning B: Planning and Design, 15(2):153–163, 1988. doi:10.1068/b150153.</a></p></li>
</ul>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../_sources/notebooks/lscp_capacity.ipynb.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2020-, pysal developers.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 8.2.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>